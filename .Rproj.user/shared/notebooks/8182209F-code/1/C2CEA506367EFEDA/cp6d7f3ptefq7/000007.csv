"0","library(rpart)
library(rpart.plot)
# Question 1 
age <- read.csv(""handout/Data/age_stats315B.csv"", header= T)
for (i in 1:ncol(age)){
  age[,i] <- as.factor(age[,i])
}
# Y = age[,1]
# X = age[,-1]
# tree <- rpart(Y~X)
tree <- rpart(age ~., data = age, method = ""class"")
rpart.plot(tree)
summary(tree)
"
"1","Call:
"
"1","rpart(formula = age ~ ., data = age, method = ""class"")
"
"1","  n="
"1"," "
"1","8710"
"1"," "
"1","

"
"1"," "
"1","         CP"
"1"," nsplit"
"1"," rel error"
"1","    xerror"
"1","        xstd"
"1","
1"
"1"," 0.12821297"
"1","      0"
"1"," 1.0000000"
"1"," 1.0000000"
"1"," 0.006179661"
"1","
2"
"1"," 0.08629131"
"1","      1"
"1"," 0.8717870"
"1"," 0.8717870"
"1"," 0.006791529"
"1","
3"
"1"," 0.06058752"
"1","      2"
"1"," 0.7854957"
"1"," 0.7854957"
"1"," 0.007024341"
"1","
4"
"1"," 0.03855569"
"1","      3"
"1"," 0.7249082"
"1"," 0.7249082"
"1"," 0.007111824"
"1","
5"
"1"," 0.02210832"
"1","      4"
"1"," 0.6863525"
"1"," 0.6863525"
"1"," 0.007136257"
"1","
6"
"1"," 0.01269890"
"1","      6"
"1"," 0.6421359"
"1"," 0.6421359"
"1"," 0.007134787"
"1","
7"
"1"," 0.01000000"
"1","      7"
"1"," 0.6294370"
"1"," 0.6324969"
"1"," 0.007130289"
"1","
"
"1","
Variable importance
"
"1","      Edu "
"1","    Occup "
"1","  MarStat "
"1","HouseStat "
"1","  DualInc "
"1","   Income "
"1","  Under18 "
"1"," TypeHome "
"1","  Persons "
"1","
"
"1","       20 "
"1","       18 "
"1","       17 "
"1","       15 "
"1","       11 "
"1","        9 "
"1","        6 "
"1","        2 "
"1","        2 "
"1","
"
"1","
Node number "
"1",""
"1","1"
"1",""
"1",": "
"1",""
"1","8710"
"1",""
"1"," observations"
"1",",    complexity param="
"1",""
"1","0.128213"
"1",""
"1","
"
"1","  predicted class=3  expected loss=0.7504018  P(node) =1
    class counts:   828  2083  2174  1556   870   636   563
   probabilities: 0.095 0.239 0.250 0.179 0.100 0.073 0.065"
"1"," "
"1","
"
"1","  left son="
"1",""
"1","2"
"1",""
"1"," ("
"1",""
"1","4268"
"1",""
"1"," obs)"
"1",""
"1"," right son="
"1",""
"1","3"
"1",""
"1"," ("
"1",""
"1","4442"
"1",""
"1"," obs)"
"1","
"
"1","  Primary splits:
"
"1","      MarStat   splits as  RLRRL,     improve=555.6238, (0 missing)"
"1","
"
"1","      HouseStat splits as  RRL,       improve=511.5696, (180 missing)"
"1","
"
"1","      Edu       splits as  LLRRRR,    improve=499.3220, (76 missing)"
"1","
"
"1","      Occup     splits as  RLRRRLLRL, improve=403.8474, (0 missing)"
"1","
"
"1","      Income    splits as  LRRRRRRRR, improve=354.8621, (338 missing)"
"1","
"
"1","  Surrogate splits:
"
"1","      DualInc   splits as  LRR,       agree=0.832, adj=0.658, (0 split)"
"1","
"
"1","      HouseStat splits as  RLL,       agree=0.724, adj=0.437, (0 split)"
"1","
"
"1","      Occup     splits as  RLLRRLRRL, agree=0.699, adj=0.386, (0 split)"
"1","
"
"1","      Income    splits as  LLLLRRRRR, agree=0.663, adj=0.312, (0 split)"
"1","
"
"1","      Edu       splits as  LLRRRR,    agree=0.600, adj=0.184, (0 split)"
"1","
"
"1","
Node number "
"1",""
"1","2"
"1",""
"1",": "
"1",""
"1","4268"
"1",""
"1"," observations"
"1",",    complexity param="
"1",""
"1","0.08629131"
"1",""
"1","
"
"1","  predicted class=2  expected loss=0.5707591  P(node) =0.4900115
    class counts:   816  1832  1063   376   111    44    26
   probabilities: 0.191 0.429 0.249 0.088 0.026 0.010 0.006"
"1"," "
"1","
"
"1","  left son="
"1",""
"1","4"
"1",""
"1"," ("
"1",""
"1","1050"
"1",""
"1"," obs)"
"1",""
"1"," right son="
"1",""
"1","5"
"1",""
"1"," ("
"1",""
"1","3218"
"1",""
"1"," obs)"
"1","
"
"1","  Primary splits:
"
"1","      Edu       splits as  LLRRRR,     improve=562.3539, (38 missing)"
"1","
"
"1","      HouseStat splits as  RRL,        improve=310.8559, (92 missing)"
"1","
"
"1","      Under18   splits as  RLLLLLLLLR, improve=295.2636, (0 missing)"
"1","
"
"1","      Income    splits as  LRRRRRRRR,  improve=261.9943, (178 missing)"
"1","
"
"1","      Occup     splits as  RLRRRLRRL,  improve=229.7293, (0 missing)"
"1","
"
"1","  Surrogate splits:
"
"1","      Under18 splits as  RRLLLLRLLR, agree=0.806, adj=0.210, (38 split)"
"1","
"
"1","      Occup   splits as  RRRRRLRRR,  agree=0.758, adj=0.016, (0 split)"
"1","
"
"1","
Node number "
"1",""
"1","3"
"1",""
"1",": "
"1",""
"1","4442"
"1",""
"1"," observations"
"1",",    complexity param="
"1",""
"1","0.06058752"
"1",""
"1","
"
"1","  predicted class=4  expected loss=0.7343539  P(node) =0.5099885
    class counts:    12   251  1111  1180   759   592   537
   probabilities: 0.003 0.057 0.250 0.266 0.171 0.133 0.121"
"1"," "
"1","
"
"1","  left son="
"1",""
"1","6"
"1",""
"1"," ("
"1",""
"1","3806"
"1",""
"1"," obs)"
"1",""
"1"," right son="
"1",""
"1","7"
"1",""
"1"," ("
"1",""
"1","636"
"1",""
"1"," obs)"
"1","
"
"1","  Primary splits:
"
"1","      Occup     splits as  LLLLLLLRL,  improve=322.67010, (0 missing)"
"1","
"
"1","      Under18   splits as  RLLLLLLLLR, improve=145.86890, (0 missing)"
"1","
"
"1","      HouseStat splits as  RLL,        improve=101.76260, (88 missing)"
"1","
"
"1","      DualInc   splits as  RLR,        improve= 94.68224, (0 missing)"
"1","
"
"1","      Persons   splits as  RRLLLLLLL,  improve= 93.83632, (122 missing)"
"1","
"
"1","  Surrogate splits:
"
"1","      MarStat splits as  L-LR-,      agree=0.862, adj=0.033, (0 split)"
"1","
"
"1","      Under18 splits as  LLLLLLLLLR, agree=0.857, adj=0.002, (0 split)"
"1","
"
"1","
Node number "
"1",""
"1","4"
"1",""
"1",": "
"1",""
"1","1050"
"1",""
"1"," observations"
"1","
"
"1","  predicted class=1  expected loss=0.2590476  P(node) =0.1205511
    class counts:   778   214    33    11     8     5     1
   probabilities: 0.741 0.204 0.031 0.010 0.008 0.005 0.001"
"1"," "
"1","
"
"1","
Node number "
"1",""
"1","5"
"1",""
"1",": "
"1",""
"1","3218"
"1",""
"1"," observations"
"1",",    complexity param="
"1",""
"1","0.02210832"
"1",""
"1","
"
"1","  predicted class=2  expected loss=0.4972032  P(node) =0.3694604
    class counts:    38  1618  1030   365   103    39    25
   probabilities: 0.012 0.503 0.320 0.113 0.032 0.012 0.008"
"1"," "
"1","
"
"1","  left son="
"1",""
"1","10"
"1",""
"1"," ("
"1",""
"1","817"
"1",""
"1"," obs)"
"1",""
"1"," right son="
"1",""
"1","11"
"1",""
"1"," ("
"1",""
"1","2401"
"1",""
"1"," obs)"
"1","
"
"1","  Primary splits:
"
"1","      HouseStat splits as  RRL,       improve=174.1940, (83 missing)"
"1","
"
"1","      Edu       splits as  --LLRR,    improve=165.2050, (27 missing)"
"1","
"
"1","      Occup     splits as  RLRRRLLRL, improve=164.6654, (0 missing)"
"1","
"
"1","      Persons   splits as  RRLLLLLLL, improve=159.3146, (153 missing)"
"1","
"
"1","      Income    splits as  LLRRRRRRR, improve= 97.9920, (114 missing)"
"1","
"
"1","  Surrogate splits:
"
"1","      Under18 splits as  RLLLLLLR-R, agree=0.769, adj=0.100, (83 split)"
"1","
"
"1","      Persons splits as  RRRLLLRLL,  agree=0.746, adj=0.011, (0 split)"
"1","
"
"1","
Node number "
"1",""
"1","6"
"1",""
"1",": "
"1",""
"1","3806"
"1",""
"1"," observations"
"1",",    complexity param="
"1",""
"1","0.03855569"
"1",""
"1","
"
"1","  predicted class=4  expected loss=0.6918024  P(node) =0.436969
    class counts:    11   249  1111  1173   726   402   134
   probabilities: 0.003 0.065 0.292 0.308 0.191 0.106 0.035"
"1"," "
"1","
"
"1","  left son="
"1",""
"1","12"
"1",""
"1"," ("
"1",""
"1","1596"
"1",""
"1"," obs)"
"1",""
"1"," right son="
"1",""
"1","13"
"1",""
"1"," ("
"1",""
"1","2210"
"1",""
"1"," obs)"
"1","
"
"1","  Primary splits:
"
"1","      HouseStat splits as  RLL,        improve=90.42640, (70 missing)"
"1","
"
"1","      Under18   splits as  RLLLLLLLL-, improve=73.85239, (0 missing)"
"1","
"
"1","      TypeHome  splits as  RRLRL,      improve=48.33088, (0 missing)"
"1","
"
"1","      LiveBA    splits as  LLLLR,      improve=36.00277, (381 missing)"
"1","
"
"1","      Persons   splits as  RRLLLLLLR,  improve=35.43460, (87 missing)"
"1","
"
"1","  Surrogate splits:
"
"1","      TypeHome splits as  RRLRL,     agree=0.801, adj=0.526, (70 split)"
"1","
"
"1","      Income   splits as  LLLLLRRRR, agree=0.691, adj=0.262, (0 split)"
"1","
"
"1","      MarStat  splits as  R-LR-,     agree=0.645, adj=0.153, (0 split)"
"1","
"
"1","      DualInc  splits as  LRR,       agree=0.641, adj=0.142, (0 split)"
"1","
"
"1","      Occup    splits as  RLLLRLL-L, agree=0.632, adj=0.121, (0 split)"
"1","
"
"1","
Node number "
"1",""
"1","7"
"1",""
"1",": "
"1",""
"1","636"
"1",""
"1"," observations"
"1","
"
"1","  predicted class=7  expected loss=0.3663522  P(node) =0.07301952
    class counts:     1     2     0     7    33   190   403
   probabilities: 0.002 0.003 0.000 0.011 0.052 0.299 0.634"
"1"," "
"1","
"
"1","
Node number "
"1",""
"1","10"
"1",""
"1",": "
"1",""
"1","817"
"1",""
"1"," observations"
"1","
"
"1","  predicted class=2  expected loss=0.1811506  P(node) =0.09380023
    class counts:    31   669    95    15     2     4     1
   probabilities: 0.038 0.819 0.116 0.018 0.002 0.005 0.001"
"1"," "
"1","
"
"1","
Node number "
"1",""
"1","11"
"1",""
"1",": "
"1",""
"1","2401"
"1",""
"1"," observations"
"1",",    complexity param="
"1",""
"1","0.02210832"
"1",""
"1","
"
"1","  predicted class=2  expected loss=0.604748  P(node) =0.2756602
    class counts:     7   949   935   350   101    35    24
   probabilities: 0.003 0.395 0.389 0.146 0.042 0.015 0.010"
"1"," "
"1","
"
"1","  left son="
"1",""
"1","22"
"1",""
"1"," ("
"1",""
"1","976"
"1",""
"1"," obs)"
"1",""
"1"," right son="
"1",""
"1","23"
"1",""
"1"," ("
"1",""
"1","1425"
"1",""
"1"," obs)"
"1","
"
"1","  Primary splits:
"
"1","      Income  splits as  LLLRRRRRR, improve=96.70470, (68 missing)"
"1","
"
"1","      Occup   splits as  RLRRRLLRR, improve=85.93692, (0 missing)"
"1","
"
"1","      Edu     splits as  --LLRR,    improve=83.32219, (19 missing)"
"1","
"
"1","      Persons splits as  RRRLLLLLL, improve=38.69356, (117 missing)"
"1","
"
"1","      LiveBA  splits as  LLLRR,     improve=19.48925, (221 missing)"
"1","
"
"1","  Surrogate splits:
"
"1","      Occup    splits as  RRRRLLLRL,  agree=0.700, adj=0.263, (68 split)"
"1","
"
"1","      Edu      splits as  --LRRR,     agree=0.625, adj=0.077, (0 split)"
"1","
"
"1","      TypeHome splits as  RRRLL,      agree=0.611, adj=0.043, (0 split)"
"1","
"
"1","      Under18  splits as  RRRRLRLR-R, agree=0.595, adj=0.004, (0 split)"
"1","
"
"1","
Node number "
"1",""
"1","12"
"1",""
"1",": "
"1",""
"1","1596"
"1",""
"1"," observations"
"1","
"
"1","  predicted class=3  expected loss=0.5814536  P(node) =0.1832377
    class counts:     9   216   668   416   184    73    30
   probabilities: 0.006 0.135 0.419 0.261 0.115 0.046 0.019"
"1"," "
"1","
"
"1","
Node number "
"1",""
"1","13"
"1",""
"1",": "
"1",""
"1","2210"
"1",""
"1"," observations"
"1",",    complexity param="
"1",""
"1","0.0126989"
"1",""
"1","
"
"1","  predicted class=4  expected loss=0.6574661  P(node) =0.2537313
    class counts:     2    33   443   757   542   329   104
   probabilities: 0.001 0.015 0.200 0.343 0.245 0.149 0.047"
"1"," "
"1","
"
"1","  left son="
"1",""
"1","26"
"1",""
"1"," ("
"1",""
"1","975"
"1",""
"1"," obs)"
"1",""
"1"," right son="
"1",""
"1","27"
"1",""
"1"," ("
"1",""
"1","1235"
"1",""
"1"," obs)"
"1","
"
"1","  Primary splits:
"
"1","      Under18 splits as  RLLLLLR-L-, improve=78.61524, (0 missing)"
"1","
"
"1","      Persons splits as  RRLLLLRLR,  improve=40.62282, (46 missing)"
"1","
"
"1","      DualInc splits as  RLR,        improve=20.79117, (0 missing)"
"1","
"
"1","      LiveBA  splits as  RLLLR,      improve=15.60334, (219 missing)"
"1","
"
"1","      MarStat splits as  L-LR-,      improve=12.78300, (0 missing)"
"1","
"
"1","  Surrogate splits:
"
"1","      Persons  splits as  RRLLLLLRL, agree=0.833, adj=0.622, (0 split)"
"1","
"
"1","      Ethnic   splits as  RLLRLRRR,  agree=0.573, adj=0.032, (0 split)"
"1","
"
"1","      Occup    splits as  RRLRLLR-R, agree=0.566, adj=0.015, (0 split)"
"1","
"
"1","      TypeHome splits as  RRLRR,     agree=0.561, adj=0.004, (0 split)"
"1","
"
"1","
Node number "
"1",""
"1","22"
"1",""
"1",": "
"1",""
"1","976"
"1",""
"1"," observations"
"1","
"
"1","  predicted class=2  expected loss=0.397541  P(node) =0.1120551
    class counts:     5   588   285    65    12     9    12
   probabilities: 0.005 0.602 0.292 0.067 0.012 0.009 0.012"
"1"," "
"1","
"
"1","
Node number "
"1",""
"1","23"
"1",""
"1",": "
"1",""
"1","1425"
"1",""
"1"," observations"
"1","
"
"1","  predicted class=3  expected loss=0.5438596  P(node) =0.1636051
    class counts:     2   361   650   285    89    26    12
   probabilities: 0.001 0.253 0.456 0.200 0.062 0.018 0.008"
"1"," "
"1","
"
"1","
Node number "
"1",""
"1","26"
"1",""
"1",": "
"1",""
"1","975"
"1",""
"1"," observations"
"1","
"
"1","  predicted class=4  expected loss=0.4974359  P(node) =0.1119403
    class counts:     1    14   241   490   192    34     3
   probabilities: 0.001 0.014 0.247 0.503 0.197 0.035 0.003"
"1"," "
"1","
"
"1","
Node number "
"1",""
"1","27"
"1",""
"1",": "
"1",""
"1","1235"
"1",""
"1"," observations"
"1","
"
"1","  predicted class=5  expected loss=0.7165992  P(node) =0.141791
    class counts:     1    19   202   267   350   295   101
   probabilities: 0.001 0.015 0.164 0.216 0.283 0.239 0.082"
"1"," "
"1","
"
"1","
"
"0","# pruned <- prune(tree, cp = 0.012699)"
"0","# rpart.plot(pruned)"
"0",""
