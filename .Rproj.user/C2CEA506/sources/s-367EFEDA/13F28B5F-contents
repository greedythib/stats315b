---
title: "STATS305B - HW1"
author: "Thibaud Bruyelle"
date: "5/1/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question 1 


```{r cars}
library(rpart)
library(rpart.plot)
# Question 1 
age <- read.csv("handout/Data/age_stats315B.csv", header= T)
for (i in 1:ncol(age)){
  age[,i] <- as.factor(age[,i])
}
# Y = age[,1]
# X = age[,-1]
# tree <- rpart(Y~X)
tree <- rpart(age ~., data = age, method = "class")
rpart.plot(tree)
summary(tree)
# pruned <- prune(tree, cp = 0.012699)
# rpart.plot(pruned)

```

The plot of the tree shows $7$ splits and $15$ nodes (leaves included). We also notice that there is not prediction for people who are between 55 and 64 years old. It seems relevant that the marital status is a great split to classify since the population gets married or dies at 
approximately the same age. Then education and occupation are also good splits because they gather people with the same age, and reached almost everybody. 

### (a)

Yes, some surrogates variables were used during the construction. Let us give an explanation of the output from `summary(tree)` : for the root that use the marital status to split, there were no missing values so there was no need to use any surrogate variables. Conversely, for node 2 (Education) there were $38$ values and the surrogate variable `Under18` was used to handle these missing values. 

### (b)

```{r}
my_covariates = X[1,]
my_covariates[1] = 6
my_covariates[2] = 3
my_covariates[3] = 1
my_covariates[4] = 5
my_covariates[5] = 6
my_covariates[6] = 1
my_covariates[7] = 1
my_covariates[8] = 1
my_covariates[9] = 4
my_covariates[10] = 0
my_covariates[11] = 2
my_covariates[12] = 7
my_covariates[13] = 3

predict(tree, my_covariates)
```



